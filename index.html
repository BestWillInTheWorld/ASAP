<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ASAP Demo</title>
<script src="plotly-latest.min.js"></script>
<script src="jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

</head>
<body>
<script src="ASAP-optimized.js" type="application/javascript"></script>

<div class="container">
	<div class="jumbotron" style="margin-top: 20px; padding-top: 10px; padding-bottom: 10px;">
	  <h2>ASAP: Automatic Smoothing for Attention Prioritization in Time Series</h2>
	<div class="lead">
	<p>ASAP automatically smoothes time series plots to remove short-term noise while retaining large-scale deviations.</p>
	<p>A little smoothing can go a long way: try ASAP below!</p>
	<p>Empirically, ASAP can improve accuracy by up to 38.4% while reducing response times by up to 44.3%.</p>
	<p>Check out our <a href="https://arxiv.org/pdf/1703.00983.pdf">paper</a> and the Monitorama <a href="https://vimeo.com/221062931">talk</a> for details.
	 [<a href="https://speakerdeck.com/futuredata/automating-dashboard-displays-with-asap">slides</a>]  [<a href="#code">code</a>]  [<a href="http://dawn.cs.stanford.edu/2017/08/07/asap/">blog post</a>]
	</p>
	</div>
	</div>

		<div id="original" style="width:1000px;height:250px;"></div>
	<div id="smoothed" style="width:1000px;height:250px;"></div>

<script>
	var windowSize = 1000;
	var stepSize = 2;
	var updateTimeMs = 100;

	var data = Array.from(new Array(100000),(val,index)=>Math.random());

	var resolution = 800;
	var layout = {
	  xaxis: { fixedrange: true },
	  yaxis: { fixedrange: true },
	  margin: { t: 30 }
	};


	$( document ).ready(function() {
		var startdata = data.slice(0, windowSize);

		console.log(startdata);

		var xs = Array.apply(null, Array(windowSize)).map(function (_, i) {return i;});

	    console.log( "ready!" );
		layout.title = 'Original (Raw Series)';
		Plotly.newPlot( document.getElementById('original'), [{
			x: xs,
			y: startdata }], layout );

		layout.title = 'ASAP (Smoothed Series)';	
		var y = smooth(startdata, 1000);
		Plotly.newPlot( document.getElementById('smoothed'), [{
			x: xs,
			y: y }], layout);

		var cnt = 1;

		var intervalID = setInterval(function(){
			console.log("SUP", cnt);
			cnt += 1;
			var curData = data.slice(cnt*stepSize, cnt*stepSize+windowSize);
			console.log(curData);
			var curDataSmoothed = smooth(curData, 1000);

			layout.title = 'Original (Raw Series)';
			Plotly.restyle(document.getElementById('original'),
						  'y', [curData]);

			layout.title = 'ASAP (Smoothed Series)';	
			Plotly.restyle(document.getElementById('smoothed'),
						  'y',
						  [curDataSmoothed]);
		}, updateTimeMs);

		});
</script>


</body>
</html>