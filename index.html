<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ASAP Demo</title>
<script src="plotly-latest.min.js"></script>
<script src="jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

</head>
<body>
<script src="ASAP-optimized.js" type="application/javascript"></script>

<div class="container">
	<div class="jumbotron" style="margin-top: 20px; padding-top: 10px; padding-bottom: 10px;">
	  <h2>ASAP: Automatic Smoothing for Attention Prioritization in Time Series</h2>
	<div class="lead">
	<p>ASAP automatically smoothes time series plots to remove short-term noise while retaining large-scale deviations.</p>
	<p>A little smoothing can go a long way: try ASAP below!</p>
	<p>Empirically, ASAP can improve accuracy by up to 38.4% while reducing response times by up to 44.3%.</p>
	<p>Check out our <a href="https://arxiv.org/pdf/1703.00983.pdf">paper</a> and the Monitorama <a href="https://vimeo.com/221062931">talk</a> for details.
	 [<a href="https://speakerdeck.com/futuredata/automating-dashboard-displays-with-asap">slides</a>]  [<a href="#code">code</a>]  [<a href="http://dawn.cs.stanford.edu/2017/08/07/asap/">blog post</a>]
	</p>
	</div>
	</div>

<script>
	var file = "Taxi.csv";
	var resolution = 800;
    var reader = new FileReader();
    var layout = {
    	xaxis: { fixedrange: true },
    	yaxis: { fixedrange: true },
    	margin: { t: 30 }
    };

    read = function (reader) {
    	var data = [];
        var allTextLines = reader.result.split(/\r\n|\n/);
	    for (var i = 1; i < allTextLines.length; i++) {
	        var cell = allTextLines[i].split(',');
	        data.push(parseFloat(cell[cell.length - 1]))
	    }
	    return data;
	}

	plotExample = function (id) {
	var reader = new FileReader();
		    reader.onload = function () {
		        var data = read(reader);
	            layout.title = 'Original (Raw Series)';
			    Plotly.newPlot( document.getElementById('original'), [{
					x: Array.apply(null, Array(data.length)).map(function (_, i) {return i;}),
					y: data }], layout );
	            layout.title = 'ASAP (Smoothed Series)';
			    var y = smooth(data, 1000);
				Plotly.newPlot( document.getElementById('smoothed'), [{
					x: Array.apply(null, Array(y.length)).map(function (_, i) {return i;}),
					y: y }], layout);
				};
			reader.readAsText("File.csv");
			};



	plot = function () {
	    reader.readAsBinaryString(fileInput.files[0]);
		var pixels = resolution.value;
	    reader.onload = function () {
	        var data = read(reader);
            layout.title = 'Original (Raw Series)';
		    Plotly.newPlot( document.getElementById('original'), [{
				x: Array.apply(null, Array(data.length)).map(function (_, i) {return i;}),
				y: data }], layout );
            layout.title = 'ASAP (Smoothed Series)';
		    var y = smooth(data, pixels);
			Plotly.newPlot( document.getElementById('smoothed'), [{
				x: Array.apply(null, Array(y.length)).map(function (_, i) {return i;}),
				y: y }], layout  );
			};
	};

	$(".btn").click(function() {
	  $(":button").removeClass("active");
	  $(this).addClass("active");
	});

	$( window ).on( "load", function() {
		$("#data0").addClass("active");
	    plotExample(0);
	});
</script>


</body>
</html>