<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ASAP Demo</title>
<script src="plotly-latest.min.js"></script>
<script src="jquery.min.js"></script>
<script src="machine_array.txt"></script>
<link  rel="stylesheet" href="divs.css" >
<link  rel="stylesheet" href="bootstrap.min.css" >

</head>
<body>
<script src="ASAP-optimized.js" type="application/javascript"></script>

<div class="container">
	<div id="sides" style="margin-top: 100px">
		<div id='left'>
			<div id="original" style="width:100%;height:200px;float:left"></div>
			<div id="smoothed" style="width:100%;height:200px;float:left"></div>
		</div>
		<div id='right' class="lead">
			<p><b>Note:</b></p>
			<ul class="list-group">
				<li class="list-group-item">ASAP is more legible</li>
				<li class="list-group-item">No parameter tuning required</li>
				<li class="list-group-item">Interactive speed</li>
				<li class="list-group-item">Lightweight enough to run in browser</li>
			</ul>
		</div>

<script>
	var windowSize = 3000;
	var stepSize = 12;
	var updateTimeMs = 150;
	var offset = 0;
	var targetRes = 1000;

	var resolution = 800;
	var orig_layout = {
	  title: 'Original (Raw Series)',
	  xaxis: { range: [0, 1000] },
	  yaxis: { range: [0, 110], showticklabels: false },
	  margin: { t: 30, l: 20, b: 30 }
	};
	var smoothed_layout = {
	  title: 'ASAP (Smoothed Series)',
	  xaxis: { range: [0, 1000] },
	  yaxis: {showticklabels: false },
	  margin: { t: 30, l: 20 }
	};


	$( document ).ready(function() {
		var startdata = data.slice(offset, offset + windowSize);

		var xs = Array.apply(null, Array(windowSize)).map(function (_, i) {return i;});
		var original_xs = Array.apply(
			null, Array(windowSize)).map(function (_, i) {return i * targetRes * 1.0 / windowSize;});

		Plotly.newPlot( document.getElementById('original'), [{
			x: original_xs,
			y: startdata }], orig_layout );

		var results = smooth(startdata, targetRes, 1);
		Plotly.newPlot( document.getElementById('smoothed'), [{
			x: xs,
			y: results.smoothed }], smoothed_layout);

		var cnt = 1;

		var intervalID = setInterval(function(){
			cnt += 1;
			var curData = data.slice(offset + cnt*stepSize, offset + cnt*stepSize+windowSize);
			results = smooth(curData, targetRes, results.window);

			Plotly.restyle(document.getElementById('original'),
						  'y', [curData]);

			Plotly.restyle(document.getElementById('smoothed'),
						  'y',[results.smoothed]);
		}, updateTimeMs);

		});
</script>


</body>
</html>